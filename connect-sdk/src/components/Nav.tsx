import { NavLink, useNavigate } from 'react-router-dom'
import { venlyConnect } from '../libs/venlyConnect'
import venly from '../assets/venly.svg'
import { useProfile } from '../hooks/useProfile'
import { useSetAtom } from 'jotai'
import { walletsAtom } from '../libs/atoms'
import Skeleton from 'react-loading-skeleton'

export default function Nav() {
  const navigate = useNavigate()
  const { profile, setProfile } = useProfile(true)
  const setWallets = useSetAtom(walletsAtom)

  async function logout() {
    await venlyConnect.logout()
    setProfile(null)
    setWallets(null)
    navigate('/login')
  }

  return (
    <nav className="nav">
      <NavLink to="/" className="nav__home">
        <div className="nav__icon">
          <img src={venly} alt="Venly logo" />
        </div>
        <h1 className="nav__heading">Venly Demo</h1>
      </NavLink>
      <div className="nav__links">
        <NavLink to="/" className="nav__link">
          <svg viewBox="0 0 24 24" fill="none">
            <path d="M8 17H16M11.0177 2.764L4.23539 8.03912C3.78202 8.39175 3.55534 8.56806 3.39203 8.78886C3.24737 8.98444 3.1396 9.20478 3.07403 9.43905C3 9.70352 3 9.9907 3 10.5651V17.8C3 18.9201 3 19.4801 3.21799 19.908C3.40973 20.2843 3.71569 20.5903 4.09202 20.782C4.51984 21 5.07989 21 6.2 21H17.8C18.9201 21 19.4802 21 19.908 20.782C20.2843 20.5903 20.5903 20.2843 20.782 19.908C21 19.4801 21 18.9201 21 17.8V10.5651C21 9.9907 21 9.70352 20.926 9.43905C20.8604 9.20478 20.7526 8.98444 20.608 8.78886C20.4447 8.56806 20.218 8.39175 19.7646 8.03913L12.9823 2.764C12.631 2.49075 12.4553 2.35412 12.2613 2.3016C12.0902 2.25526 11.9098 2.25526 11.7387 2.3016C11.5447 2.35412 11.369 2.49075 11.0177 2.764Z" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"/>
          </svg>
          Home
        </NavLink>
      </div>
      <div className="nav__footer">
        <a href="https://www.venly.io" target="_blank" className="nav__link">
          <svg viewBox="0 0 560 517" fill="none">
            <path d="M554.555 169.276L485.867 195.365C482.979 196.415 480.179 193.614 481.404 190.725L557.968 4.86083C559.105 2.0593 556.393 -0.829778 553.593 0.220795L408.078 51.1736C405.278 52.1366 403.003 54.3253 401.866 57.1268L303.252 306.025C302.027 309.177 305.089 312.329 308.239 311.19L369.84 288.603C373.253 287.377 376.403 291.054 374.565 294.294L284.089 447.94C282.164 451.267 277.264 451.267 275.339 447.94L184.863 294.206C183.025 291.054 186.088 287.29 189.588 288.516L251.189 311.103C254.339 312.241 257.401 309.089 256.176 305.938L157.475 57.1268C156.337 54.3253 154.15 52.2242 151.262 51.1736L5.92267 0.220795C3.03513 -0.74223 0.410092 2.0593 1.54761 4.86083L78.0237 190.725C79.1612 193.526 76.3612 196.415 73.5611 195.365L5.31016 169.276C1.81011 167.962 -1.33993 171.727 0.585095 174.966L203.763 511.5C205.775 514.826 209.363 516.84 213.301 516.84H346.477C350.328 516.84 354.003 514.826 356.015 511.5L559.543 174.966C561.205 171.727 558.055 167.962 554.555 169.276Z" fill="currentColor"/>
          </svg>
          Venly.io
        </a>
        <a href="https://github.com/ArkaneNetwork/react-demo" target="_blank" className="nav__link">
          <svg viewBox="0 0 24 24" fill="none">
            <path fill="currentColor" fillRule="evenodd" clipRule="evenodd" d="M12 0C5.3724 0 0 5.3808 0 12.0204C0 17.3304 3.438 21.8364 8.2068 23.4252C8.8068 23.5356 9.0252 23.1648 9.0252 22.8456C9.0252 22.5612 9.0156 21.804 9.0096 20.802C5.6712 21.528 4.9668 19.1904 4.9668 19.1904C4.422 17.8008 3.6348 17.4312 3.6348 17.4312C2.5452 16.6872 3.7176 16.7016 3.7176 16.7016C4.9212 16.7856 5.5548 17.94 5.5548 17.94C6.6252 19.776 8.364 19.2456 9.0468 18.9384C9.1572 18.162 9.4668 17.6328 9.81 17.3328C7.146 17.0292 4.344 15.9972 4.344 11.3916C4.344 10.08 4.812 9.006 5.5788 8.166C5.4552 7.8624 5.0436 6.6396 5.6964 4.986C5.6964 4.986 6.7044 4.662 8.9964 6.2172C9.97532 5.95022 10.9853 5.81423 12 5.8128C13.02 5.8176 14.046 5.9508 15.0048 6.2172C17.2956 4.662 18.3012 4.9848 18.3012 4.9848C18.9564 6.6396 18.5436 7.8624 18.4212 8.166C19.1892 9.006 19.6548 10.08 19.6548 11.3916C19.6548 16.0092 16.848 17.0256 14.1756 17.3232C14.6064 17.694 14.9892 18.4272 14.9892 19.5492C14.9892 21.1548 14.9748 22.452 14.9748 22.8456C14.9748 23.1672 15.1908 23.5416 15.8004 23.424C18.19 22.6225 20.2672 21.0904 21.7386 19.0441C23.2099 16.9977 24.001 14.5408 24 12.0204C24 5.3808 18.6264 0 12 0Z"/>
          </svg>
          GitHub
        </a>
        <a href="https://docs.venly.io/docs" target="_blank" className="nav__link">
          <svg viewBox="0 0 24 24" fill="none">
            <path d="M7.5 10.5H7.51M12 10.5H12.01M16.5 10.5H16.51M9.9 19.2L11.36 21.1467C11.5771 21.4362 11.6857 21.5809 11.8188 21.6327C11.9353 21.678 12.0647 21.678 12.1812 21.6327C12.3143 21.5809 12.4229 21.4362 12.64 21.1467L14.1 19.2C14.3931 18.8091 14.5397 18.6137 14.7185 18.4645C14.9569 18.2656 15.2383 18.1248 15.5405 18.0535C15.7671 18 16.0114 18 16.5 18C17.8978 18 18.5967 18 19.1481 17.7716C19.8831 17.4672 20.4672 16.8831 20.7716 16.1481C21 15.5967 21 14.8978 21 13.5V7.8C21 6.11984 21 5.27976 20.673 4.63803C20.3854 4.07354 19.9265 3.6146 19.362 3.32698C18.7202 3 17.8802 3 16.2 3H7.8C6.11984 3 5.27976 3 4.63803 3.32698C4.07354 3.6146 3.6146 4.07354 3.32698 4.63803C3 5.27976 3 6.11984 3 7.8V13.5C3 14.8978 3 15.5967 3.22836 16.1481C3.53284 16.8831 4.11687 17.4672 4.85195 17.7716C5.40326 18 6.10218 18 7.5 18C7.98858 18 8.23287 18 8.45951 18.0535C8.76169 18.1248 9.04312 18.2656 9.2815 18.4645C9.46028 18.6137 9.60685 18.8091 9.9 19.2ZM8 10.5C8 10.7761 7.77614 11 7.5 11C7.22386 11 7 10.7761 7 10.5C7 10.2239 7.22386 10 7.5 10C7.77614 10 8 10.2239 8 10.5ZM12.5 10.5C12.5 10.7761 12.2761 11 12 11C11.7239 11 11.5 10.7761 11.5 10.5C11.5 10.2239 11.7239 10 12 10C12.2761 10 12.5 10.2239 12.5 10.5ZM17 10.5C17 10.7761 16.7761 11 16.5 11C16.2239 11 16 10.7761 16 10.5C16 10.2239 16.2239 10 16.5 10C16.7761 10 17 10.2239 17 10.5Z" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"/>
          </svg>
          Documentation
        </a>
        <div className="nav-user">
          <div className="nav-user__profile">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
              <path d="M20 21C20 19.6044 20 18.9067 19.8278 18.3389C19.44 17.0605 18.4395 16.06 17.1611 15.6722C16.5933 15.5 15.8956 15.5 14.5 15.5H9.5C8.10444 15.5 7.40665 15.5 6.83886 15.6722C5.56045 16.06 4.56004 17.0605 4.17224 18.3389C4 18.9067 4 19.6044 4 21M16.5 7.5C16.5 9.98528 14.4853 12 12 12C9.51472 12 7.5 9.98528 7.5 7.5C7.5 5.01472 9.51472 3 12 3C14.4853 3 16.5 5.01472 16.5 7.5Z" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"/>
            </svg>
          </div>
          <div className="nav-user__block">
            {!profile ?
              <>
                <p className="nav-user__title"><Skeleton width={80} height={14} /></p>
                <p className="nav-user__subtitle"><Skeleton width={150} height={14} /></p>
              </>
              :
              <>
                <p className="nav-user__title">{profile?.firstName} {profile?.lastName}</p>
                <p className="nav-user__subtitle">{profile?.email}</p>
              </>
            }
          </div>
          <div className="btn btn--borderless nav-user__btn" onClick={() => logout()}>
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
              <path d="M16 17L21 12M21 12L16 7M21 12H9M9 3H7.8C6.11984 3 5.27976 3 4.63803 3.32698C4.07354 3.6146 3.6146 4.07354 3.32698 4.63803C3 5.27976 3 6.11984 3 7.8V16.2C3 17.8802 3 18.7202 3.32698 19.362C3.6146 19.9265 4.07354 20.3854 4.63803 20.673C5.27976 21 6.11984 21 7.8 21H9" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"/>
            </svg>
          </div>
        </div>
      </div>
    </nav>
  )
}
